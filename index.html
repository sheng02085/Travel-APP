<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>TravelGo</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#FFFFFF">
    
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="icon" type="image/png" href="icon.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', 'sans-serif'] },
                    colors: { ios: { bg: '#F2F2F7', blue: '#007AFF', red: '#FF3B30', green: '#34C759' } },
                    boxShadow: { 'ios': '0 4px 20px -8px rgba(0, 0, 0, 0.1)' }
                }
            }
        }
    </script>
    
    <style>
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        body { overscroll-behavior-y: none; -webkit-tap-highlight-color: transparent; }
        html, body { background-color: #FFFFFF; height: 100%; width: 100%; }

        .fade-enter-active, .fade-leave-active { transition: opacity 0.2s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
        .slide-up-enter-active, .slide-up-leave-active { transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s; }
        .slide-up-enter-from { transform: translateY(100%); opacity: 0; }
        .slide-up-leave-to { transform: translateY(20%); opacity: 0; }
        * { -webkit-touch-callout: none; }
        input, textarea, select { -webkit-user-select: text; user-select: text; }

        .safe-top { padding-top: env(safe-area-inset-top, 20px); }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom, 20px); }

        /* Ê©üÁ•®Èã∏ÈΩíÈÇäÁ∑£ÊïàÊûú */
        .ticket-dots {
            background-image: radial-gradient(#F2F2F7 50%, transparent 50%);
            background-size: 16px 16px;
            background-position: -8px -8px;
        }
    </style>
</head>

<body class="flex justify-center items-start">

    <div id="app" class="w-full h-[100dvh] bg-white flex flex-col relative overflow-hidden">
        
        <header class="absolute top-0 left-0 right-0 bg-white/95 backdrop-blur-md z-30 flex items-end pb-3 justify-between px-4 border-b border-gray-100 safe-top min-h-[60px] sm:min-h-[80px]">
            <h1 class="text-xl font-bold truncate transition-all duration-300 tracking-tight" :class="currentTab === 'profile' ? 'opacity-0' : 'opacity-100'">
                {{ pageTitle }}
            </h1>
            <button @click="currentTab = 'profile'" class="w-9 h-9 rounded-full bg-gray-100 overflow-hidden border border-gray-200 flex items-center justify-center active:scale-90 transition-transform mb-1" style="z-index: 50;">
                <img v-if="userAvatar" :src="userAvatar" class="w-full h-full object-cover">
                <i v-else class="fa-solid fa-user text-gray-400 text-sm"></i>
            </button>
        </header>

        <main class="flex-1 bg-ios-bg overflow-y-auto hide-scrollbar pt-24 pb-28 px-4 scroll-smooth">
            
            <transition name="fade" mode="out-in">
                <div v-if="currentTab === 'schedule'" key="schedule" class="space-y-6">
                    
                    <div class="sticky top-0 z-20 -mx-4 px-4 pb-2 pt-2 bg-ios-bg/95 backdrop-blur-sm">
                        <div class="flex overflow-x-auto hide-scrollbar snap-x gap-2">
                            <button v-for="day in maxDays" :key="day" 
                                @click="currentDay = day" 
                                :class="currentDay === day ? 'bg-black text-white shadow-lg scale-105' : 'bg-white text-gray-400 shadow-sm'"
                                class="flex-shrink-0 px-4 py-2 rounded-2xl text-xs font-bold transition-all duration-200 snap-center min-w-[70px] flex flex-col items-center justify-center">
                                <span class="text-[10px] opacity-60">DAY</span>
                                <span class="text-lg">{{ day }}</span>
                            </button>
                            <button @click="addNewDay" class="flex-shrink-0 w-12 rounded-2xl bg-white text-ios-blue shadow-sm flex items-center justify-center text-lg font-bold active:scale-95 transition">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <button @click="showAddSchedule = true" class="w-full bg-white py-4 rounded-3xl text-ios-blue text-sm font-bold shadow-sm active:scale-[0.98] transition-transform flex items-center justify-center gap-2 border border-blue-100">
                        <i class="fa-solid fa-location-dot"></i> Êñ∞Â¢ûË°åÁ®ãÈªû
                    </button>
                    
                    <div v-if="showAddSchedule" class="bg-white p-5 rounded-[2rem] shadow-xl space-y-4 animate-fade-in-up border border-gray-100">
                        <div class="flex justify-between items-center mb-1">
                            <h3 class="font-bold text-gray-800">Âª∫Á´ãÊñ∞Ë°åÁ®ã</h3>
                            <button @click="showAddSchedule = false" class="w-8 h-8 bg-gray-100 rounded-full text-gray-500 hover:bg-gray-200 transition"><i class="fa-solid fa-times"></i></button>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-gray-50 rounded-2xl px-3 py-2 border border-gray-100">
                                <label class="text-[10px] text-gray-400 font-bold block">ÊôÇÈñì</label>
                                <input v-model="newSchedule.time" type="time" class="bg-transparent w-full text-sm font-bold outline-none text-gray-800">
                            </div>
                            <div class="bg-gray-50 rounded-2xl px-3 py-2 border border-gray-100">
                                <label class="text-[10px] text-gray-400 font-bold block">Â§©Ê∞£</label>
                                <select v-model="newSchedule.weather" class="bg-transparent w-full text-sm font-bold outline-none text-gray-800">
                                    <option value="sunny">‚òÄÔ∏è Êô¥Â§©</option>
                                    <option value="cloudy">‚òÅÔ∏è Èô∞Â§©</option>
                                    <option value="rainy">üåßÔ∏è Èõ®Â§©</option>
                                </select>
                            </div>
                        </div>

                        <div class="bg-gray-50 rounded-2xl px-3 py-2 border border-gray-100">
                             <label class="text-[10px] text-gray-400 font-bold block">ÊóÖÈÅäÂú∞ÂçÄ</label>
                             <div class="flex gap-2 mt-1 overflow-x-auto hide-scrollbar">
                                 <button v-for="region in ['Êù±‰∫¨', 'Â§ßÈò™', '‰∫¨ÈÉΩ', 'È¶ñÁàæ', 'Âè∞Âåó']" 
                                    @click="newSchedule.region = region"
                                    :class="newSchedule.region === region ? 'bg-black text-white' : 'bg-white text-gray-500 border'"
                                    class="px-3 py-1 rounded-full text-xs font-bold whitespace-nowrap transition-colors">
                                    {{ region }}
                                 </button>
                                 <input v-model="newSchedule.region" placeholder="Ëá™Ë®Ç..." class="bg-transparent text-xs border-b border-gray-300 w-16 outline-none text-center">
                             </div>
                        </div>

                        <div class="space-y-3">
                             <input v-model="newSchedule.title" placeholder="ÊôØÈªûÂêçÁ®± (‰æãÂ¶Ç: Ê∏ÖÊ∞¥ÂØ∫)" class="w-full bg-gray-50 p-4 rounded-2xl text-sm font-bold outline-none focus:ring-2 focus:ring-black/5 transition">
                             <input v-model="newSchedule.location" placeholder="Google Maps Âú∞ÈªûÈóúÈçµÂ≠ó" class="w-full bg-gray-50 p-4 rounded-2xl text-sm outline-none focus:ring-2 focus:ring-black/5 transition">
                        </div>
                        
                        <button @click="addScheduleItem" class="w-full bg-black text-white py-4 rounded-2xl font-bold text-sm shadow-lg active:scale-95 transition">Á¢∫Ë™çÊñ∞Â¢û</button>
                    </div>
                    
                    <div class="space-y-0 relative">
                        <div class="absolute left-[26px] top-4 bottom-4 w-0.5 bg-gray-200 z-0" v-if="itineraryDisplay.length > 0"></div>

                        <div v-if="itineraryDisplay.length === 0" class="text-center py-20 opacity-30">
                            <i class="fa-solid fa-map-location-dot text-5xl mb-3"></i>
                            <p class="text-sm font-bold">Ê∫ñÂÇôÂá∫ÁôºÔºÅ<br>ÈªûÊìä‰∏äÊñπÊåâÈàïÊñ∞Â¢ûË°åÁ®ã</p>
                        </div>

                        <div v-for="(item, index) in itineraryDisplay" :key="item.id" class="relative z-10 flex gap-4 group mb-6 last:mb-0">
                            <div class="flex flex-col items-center pt-1 min-w-[50px]">
                                <div class="bg-white border-2 border-black w-3 h-3 rounded-full mb-1 shadow-sm"></div>
                                <span class="text-xs font-bold text-gray-500 font-mono bg-ios-bg px-1">{{ item.time }}</span>
                            </div>
                            
                            <div class="flex-1 bg-white p-5 rounded-[1.5rem] shadow-sm border border-gray-100 active:scale-[0.98] transition-transform relative overflow-hidden">
                                <div v-if="item.region" class="absolute top-0 right-0 bg-gray-100 px-3 py-1 rounded-bl-2xl text-[10px] font-bold text-gray-500">
                                    {{ item.region }}
                                </div>

                                <div class="flex justify-between items-start pr-8">
                                    <div>
                                        <h3 class="font-bold text-lg text-gray-900 leading-tight">{{ item.title }}</h3>
                                        <p class="text-xs text-gray-400 mt-1 flex items-center gap-1">
                                            <i class="fa-solid fa-location-dot text-ios-blue"></i> {{ item.location }}
                                        </p>
                                    </div>
                                    <span class="text-2xl" v-html="getWeatherIcon(item.weather)"></span>
                                </div>
                                
                                <div class="flex gap-2 mt-4">
                                    <a :href="'https://www.google.com/maps/search/?api=1&query=' + item.location" target="_blank" 
                                       class="px-4 py-2 bg-black text-white text-xs font-bold rounded-xl shadow-md active:bg-gray-800 transition flex items-center gap-2">
                                        <i class="fa-solid fa-location-arrow"></i> Â∞éËà™
                                    </a>
                                    <button @click="deleteSchedule(item.id)" class="px-3 py-2 text-gray-300 hover:text-red-500 transition">
                                        <i class="fa-solid fa-trash-can"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </transition>

            <transition name="fade"><div v-if="currentTab === 'map'" key="map" class="h-full w-full rounded-[2rem] overflow-hidden shadow-ios bg-white relative border border-gray-100"><iframe src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d14560.26998675127!2d120.685!3d24.125!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1szh-TW!2stw!4v1680000000000!5m2!1szh-TW!2stw" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe></div></transition>

            <transition name="fade"><div v-if="currentTab === 'wallet'" key="wallet" class="space-y-4">
                <div class="bg-gradient-to-br from-[#1c1c1e] to-[#2c2c2e] text-white p-6 rounded-[2rem] shadow-xl relative overflow-hidden"><div class="relative z-10"><p class="text-xs font-medium opacity-60 uppercase tracking-wider">Total Expenses</p><h2 class="text-4xl font-bold mt-1 tracking-tight">NT$ {{ totalExpense.toLocaleString() }}</h2></div><i class="fa-brands fa-apple-pay absolute -bottom-2 -right-2 text-8xl opacity-10 rotate-12"></i></div>
                <div class="bg-white p-5 rounded-[2rem] shadow-sm space-y-4 border border-gray-100"><h3 class="font-bold text-sm text-gray-400 ml-1">Êñ∞Â¢ûÊîØÂá∫</h3><div class="flex gap-3"><input v-model="newExpense.name" placeholder="Ê∂àË≤ªÈ†ÖÁõÆ" class="flex-1 bg-gray-50 p-4 rounded-2xl text-sm font-bold outline-none"><input v-model.number="newExpense.amount" type="number" placeholder="$" class="w-24 bg-gray-50 p-4 rounded-2xl text-sm font-bold outline-none text-center"></div><div class="flex gap-2"><div class="flex bg-gray-50 rounded-2xl p-1 flex-1"><button @click="newExpense.type = 'cash'" :class="newExpense.type === 'cash' ? 'bg-white shadow-sm text-black' : 'text-gray-400'" class="flex-1 py-3 rounded-xl text-xs font-bold transition-all">ÁèæÈáë</button><button @click="newExpense.type = 'card'" :class="newExpense.type === 'card' ? 'bg-white shadow-sm text-ios-blue' : 'text-gray-400'" class="flex-1 py-3 rounded-xl text-xs font-bold transition-all">‰ø°Áî®Âç°</button></div><button @click="addExpense" class="bg-black text-white w-14 rounded-2xl flex items-center justify-center shadow-lg active:scale-90 transition"><i class="fa-solid fa-plus"></i></button></div></div>
                <div class="space-y-3"><div v-for="(expense, idx) in expenses" :key="idx" class="bg-white p-4 rounded-2xl shadow-sm border border-gray-50 flex justify-between items-center"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-full flex items-center justify-center text-lg" :class="expense.type === 'card' ? 'bg-blue-50 text-ios-blue' : 'bg-green-50 text-green-600'"><i :class="expense.type === 'card' ? 'fa-solid fa-credit-card' : 'fa-solid fa-money-bill'"></i></div><span class="font-bold text-gray-800">{{ expense.name }}</span></div><div class="flex items-center gap-3"><span class="font-bold text-gray-900">-{{ expense.amount }}</span><button @click="deleteExpense(idx)" class="text-gray-300 hover:text-red-500"><i class="fa-solid fa-circle-minus"></i></button></div></div></div>
            </div></transition>

            <transition name="fade"><div v-if="currentTab === 'shop'" key="shop" class="space-y-4"><div class="flex gap-2"><input v-model="newShopItem" @keyup.enter="addShopItem" type="text" placeholder="Ëº∏ÂÖ•ÊÉ≥Ë≤∑ÁöÑÊù±Ë•ø..." class="flex-1 bg-white p-5 rounded-[1.5rem] shadow-sm outline-none focus:ring-2 focus:ring-black/10 font-bold text-sm"><button @click="addShopItem" class="bg-black text-white px-6 rounded-[1.5rem] font-bold shadow-md active:scale-95 transition"><i class="fa-solid fa-plus"></i></button></div><div class="space-y-2"><div v-for="(item, idx) in shopList" :key="idx" class="bg-white p-5 rounded-[1.5rem] shadow-sm border border-gray-100 flex items-center justify-between group transition-all duration-300" :class="item.done ? 'bg-gray-50' : ''"><div @click="toggleShopItem(idx)" class="flex items-center gap-4 flex-1 cursor-pointer"><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors duration-300" :class="item.done ? 'bg-black border-black' : 'border-gray-200'"><i v-if="item.done" class="fa-solid fa-check text-white text-[10px]"></i></div><span class="font-bold text-gray-800 transition-all text-lg" :class="{'line-through text-gray-400': item.done}">{{ item.name }}</span></div><button @click="deleteShopItem(idx)" class="w-8 h-8 flex items-center justify-center text-gray-300 hover:text-red-500 active:scale-90 transition"><i class="fa-solid fa-trash-can"></i></button></div></div></div></transition>

            <transition name="fade">
                <div v-if="currentTab === 'flight'" key="flight" class="space-y-6">
                    
                    <div class="bg-white p-5 rounded-[2rem] shadow-sm border border-gray-100 space-y-4">
                        <div class="flex justify-between items-center"><h3 class="font-bold text-gray-800">Ëº∏ÂÖ•ÁôªÊ©üË≥áË®ä</h3><i class="fa-solid fa-plane-departure text-gray-300"></i></div>
                        
                        <div class="flex gap-3">
                            <input v-model="newFlight.airline" placeholder="Ëà™Á©∫ÂÖ¨Âè∏ (ex: Èï∑Ê¶Æ)" class="flex-1 bg-gray-50 p-3 rounded-xl text-sm font-bold outline-none">
                            <input v-model="newFlight.flightNo" placeholder="Áè≠Ê¨° (BR198)" class="w-1/3 bg-gray-50 p-3 rounded-xl text-sm font-bold outline-none">
                        </div>
                        <div class="flex gap-3">
                            <div class="flex-1 bg-gray-50 rounded-xl px-3 py-2">
                                <label class="text-[10px] text-gray-400 block font-bold">Âá∫ÁôºÂú∞</label>
                                <input v-model="newFlight.from" placeholder="TPE" class="bg-transparent w-full text-sm font-bold outline-none">
                            </div>
                             <div class="flex items-center text-gray-300"><i class="fa-solid fa-arrow-right"></i></div>
                            <div class="flex-1 bg-gray-50 rounded-xl px-3 py-2">
                                <label class="text-[10px] text-gray-400 block font-bold">ÁõÆÁöÑÂú∞</label>
                                <input v-model="newFlight.to" placeholder="NRT" class="bg-transparent w-full text-sm font-bold outline-none">
                            </div>
                        </div>
                        <div class="grid grid-cols-3 gap-3">
                            <input v-model="newFlight.date" type="date" class="bg-gray-50 p-3 rounded-xl text-xs font-bold outline-none col-span-1">
                            <input v-model="newFlight.time" type="time" class="bg-gray-50 p-3 rounded-xl text-xs font-bold outline-none col-span-1">
                            <input v-model="newFlight.gate" placeholder="ÁôªÊ©üÈñÄ" class="bg-gray-50 p-3 rounded-xl text-xs font-bold outline-none col-span-1 text-center">
                        </div>
                        <button @click="addFlight" class="w-full bg-black text-white py-3 rounded-xl font-bold text-sm shadow active:scale-95 transition">Êñ∞Â¢ûÊ©üÁ•®</button>
                    </div>

                    <div v-if="flightList.length === 0" class="text-center py-10 opacity-30">
                        <i class="fa-solid fa-ticket text-5xl mb-3"></i>
                        <p class="text-sm font-bold">ÈÇÑÊ≤íÊúâÊ©üÁ•®Ë≥áÊñô</p>
                    </div>

                    <div v-for="(ticket, idx) in flightList" :key="idx" class="relative group">
                         <div class="bg-white rounded-[1.5rem] shadow-md overflow-hidden border border-gray-200">
                             <div class="h-3 bg-ios-blue w-full"></div>
                             <div class="p-5 pb-8 relative">
                                 <div class="flex justify-between items-start mb-6">
                                     <div>
                                         <p class="text-xs text-gray-400 font-bold uppercase tracking-wider">Airline</p>
                                         <h3 class="text-lg font-bold text-gray-800">{{ ticket.airline }} <span class="text-gray-400 text-sm ml-1">{{ ticket.flightNo }}</span></h3>
                                     </div>
                                     <i class="fa-brands fa-avianex text-3xl text-gray-200"></i>
                                 </div>
                                 
                                 <div class="flex justify-between items-center mb-6">
                                     <div class="text-center">
                                         <p class="text-3xl font-black text-gray-800">{{ ticket.from }}</p>
                                         <p class="text-[10px] text-gray-400 font-bold bg-gray-100 rounded px-1 mt-1">DEPARTURE</p>
                                     </div>
                                     <div class="flex-1 flex flex-col items-center px-4">
                                         <i class="fa-solid fa-plane text-gray-300 rotate-90 mb-1"></i>
                                         <div class="w-full h-0.5 bg-gray-200 border-t border-dashed border-gray-400"></div>
                                         <p class="text-[10px] text-gray-400 mt-1 font-mono">{{ ticket.time }}</p>
                                     </div>
                                      <div class="text-center">
                                         <p class="text-3xl font-black text-gray-800">{{ ticket.to }}</p>
                                         <p class="text-[10px] text-gray-400 font-bold bg-gray-100 rounded px-1 mt-1">ARRIVAL</p>
                                     </div>
                                 </div>

                                 <div class="grid grid-cols-3 gap-2 bg-gray-50 p-3 rounded-xl border border-gray-100">
                                     <div class="text-center border-r border-gray-200">
                                         <p class="text-[10px] text-gray-400 font-bold">DATE</p>
                                         <p class="font-bold text-gray-800 text-sm">{{ ticket.date }}</p>
                                     </div>
                                     <div class="text-center border-r border-gray-200">
                                         <p class="text-[10px] text-gray-400 font-bold">GATE</p>
                                         <p class="font-bold text-ios-blue text-lg">{{ ticket.gate || '-' }}</p>
                                     </div>
                                     <div class="text-center">
                                         <p class="text-[10px] text-gray-400 font-bold">SEAT</p>
                                         <p class="font-bold text-gray-800 text-sm">--</p>
                                     </div>
                                 </div>
                             </div>
                             <div class="relative h-4 bg-gray-100 border-t border-dashed border-gray-300 mx-1"></div>
                             <button @click="deleteFlight(idx)" class="absolute top-4 right-4 text-gray-300 hover:text-red-500 p-2"><i class="fa-solid fa-trash"></i></button>
                         </div>
                    </div>
                </div>
            </transition>

        </main>

        <nav v-if="currentTab !== 'profile'" class="absolute bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-100 flex justify-around items-start pt-3 z-30 safe-bottom">
            <button @click="currentTab = 'schedule'" class="flex flex-col items-center gap-1 w-14 group"><i class="fa-solid fa-calendar-days text-xl transition-all duration-300" :class="currentTab === 'schedule' ? 'text-black scale-110' : 'text-gray-300'"></i><span class="text-[10px] font-bold" :class="currentTab === 'schedule' ? 'text-black' : 'text-gray-300'">Ë°åÁ®ã</span></button>
            <button @click="currentTab = 'map'" class="flex flex-col items-center gap-1 w-14 group"><i class="fa-solid fa-map text-xl transition-all duration-300" :class="currentTab === 'map' ? 'text-black scale-110' : 'text-gray-300'"></i><span class="text-[10px] font-bold" :class="currentTab === 'map' ? 'text-black' : 'text-gray-300'">Âú∞Âúñ</span></button>
            <button @click="currentTab = 'wallet'" class="flex flex-col items-center gap-1 w-14 group"><i class="fa-solid fa-wallet text-xl transition-all duration-300" :class="currentTab === 'wallet' ? 'text-black scale-110' : 'text-gray-300'"></i><span class="text-[10px] font-bold" :class="currentTab === 'wallet' ? 'text-black' : 'text-gray-300'">Ë®òÂ∏≥</span></button>
            <button @click="currentTab = 'shop'" class="flex flex-col items-center gap-1 w-14 group"><i class="fa-solid fa-bag-shopping text-xl transition-all duration-300" :class="currentTab === 'shop' ? 'text-black scale-110' : 'text-gray-300'"></i><span class="text-[10px] font-bold" :class="currentTab === 'shop' ? 'text-black' : 'text-gray-300'">Ë≥ºÁâ©</span></button>
            <button @click="currentTab = 'flight'" class="flex flex-col items-center gap-1 w-14 group"><i class="fa-solid fa-plane-up text-xl transition-all duration-300" :class="currentTab === 'flight' ? 'text-black scale-110' : 'text-gray-300'"></i><span class="text-[10px] font-bold" :class="currentTab === 'flight' ? 'text-black' : 'text-gray-300'">ÁôªÊ©ü</span></button>
        </nav>

        <transition name="slide-up">
            <div v-if="currentTab === 'profile'" class="absolute inset-0 bg-white z-50 flex flex-col safe-top">
                <div class="h-14 bg-white/95 backdrop-blur-md flex items-center justify-between px-4 border-b border-gray-100 min-h-[60px]"><span class="text-lg font-bold">ÂÄã‰∫∫‰∏≠ÂøÉ</span><button @click="currentTab = 'schedule'" class="text-ios-blue font-bold text-sm bg-gray-50 px-3 py-1.5 rounded-full active:bg-gray-100">ÂÆåÊàê</button></div>
                <div class="flex-1 overflow-y-auto p-4 space-y-6 bg-ios-bg">
                    <div class="bg-white p-6 rounded-[2rem] shadow-sm flex flex-col items-center mt-4"><div class="w-24 h-24 rounded-full bg-gray-100 mb-4 relative overflow-hidden group"><i v-if="!userAvatar" class="fa-solid fa-user text-4xl text-gray-300 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></i><img v-else :src="userAvatar" class="w-full h-full object-cover"></div><input v-model="userName" @input="saveToLocal" type="text" class="text-center text-xl font-bold bg-transparent border-b border-gray-200 focus:border-ios-blue outline-none pb-1" placeholder="Ëº∏ÂÖ•ÊÇ®ÁöÑÂêçÂ≠ó"></div>
                    <div class="bg-white rounded-[2rem] shadow-sm overflow-hidden"><div class="p-4 border-b border-gray-100 flex justify-between items-center"><span class="font-bold text-gray-700">Á∏ΩË°åÁ®ãÊï∏</span><span class="text-gray-400">{{ itineraryData.length }}</span></div><div class="p-4 border-b border-gray-100 flex justify-between items-center"><span class="font-bold text-gray-700">Á∏ΩÊ∂àË≤ª</span><span class="text-gray-400">NT$ {{ totalExpense }}</span></div><button @click="resetAllData" class="w-full p-4 text-ios-red font-bold text-center active:bg-gray-50 transition">ÈáçÁΩÆÊâÄÊúâË≥áÊñô</button></div>
                    <p class="text-center text-xs text-gray-400 mt-4">TravelGo v5.0 (Pro UI)</p>
                </div>
            </div>
        </transition>

    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        const { createApp, ref, computed, onMounted } = Vue;
        createApp({
            setup() {
                const currentTab = ref('schedule'); const currentDay = ref(1); const showAddSchedule = ref(false);
                const itineraryData = ref([]); const expenses = ref([]); const shopList = ref([]); const flightList = ref([]); 
                const userName = ref(''); const userAvatar = ref('');
                
                // Êñ∞Â¢ûÊ¨Ñ‰Ωç: region
                const newSchedule = ref({ time: '10:00', title: '', location: '', weather: 'sunny', region: 'Êù±‰∫¨' }); 
                const newExpense = ref({ name: '', amount: '', type: 'cash' }); const newShopItem = ref('');
                const newFlight = ref({ airline: '', flightNo: '', from: '', to: '', date: '', time: '', gate: '' });

                const saveToLocal = () => {
                    localStorage.setItem('tg_itinerary', JSON.stringify(itineraryData.value));
                    localStorage.setItem('tg_expenses', JSON.stringify(expenses.value));
                    localStorage.setItem('tg_shop', JSON.stringify(shopList.value));
                    localStorage.setItem('tg_flights', JSON.stringify(flightList.value));
                    localStorage.setItem('tg_name', userName.value);
                };
                const loadFromLocal = () => {
                    try {
                        if(localStorage.getItem('tg_itinerary')) itineraryData.value = JSON.parse(localStorage.getItem('tg_itinerary'));
                        if(localStorage.getItem('tg_expenses')) expenses.value = JSON.parse(localStorage.getItem('tg_expenses'));
                        if(localStorage.getItem('tg_shop')) shopList.value = JSON.parse(localStorage.getItem('tg_shop'));
                        if(localStorage.getItem('tg_flights')) flightList.value = JSON.parse(localStorage.getItem('tg_flights'));
                        if(localStorage.getItem('tg_name')) userName.value = localStorage.getItem('tg_name');
                    } catch(e) {}
                };
                onMounted(() => loadFromLocal());

                const pageTitle = computed(() => ({ schedule: 'ÊàëÁöÑË°åÁ®ã', map: 'Êé¢Á¥¢Âú∞Âúñ', wallet: 'ÊóÖË°åÈå¢ÂåÖ', shop: 'Ë≥ºÁâ©Ê∏ÖÂñÆ', flight: 'ÁôªÊ©üË≠â', profile: 'ÂÄã‰∫∫‰∏≠ÂøÉ' }[currentTab.value] || 'TravelGo'));
                const maxDays = computed(() => itineraryData.value.length ? Math.max(currentDay.value, Math.max(...itineraryData.value.map(i => i.day))) : currentDay.value);
                const itineraryDisplay = computed(() => itineraryData.value.filter(item => item.day === currentDay.value).sort((a, b) => a.time.localeCompare(b.time)));
                const totalExpense = computed(() => expenses.value.reduce((sum, item) => sum + item.amount, 0));
                const getWeatherIcon = (w) => ({ 'sunny': '‚òÄÔ∏è', 'cloudy': '‚òÅÔ∏è', 'rainy': 'üåßÔ∏è' }[w] || 'üå§Ô∏è');

                const addNewDay = () => { currentDay.value = maxDays.value + 1; };
                const addScheduleItem = () => { if(newSchedule.value.title) { itineraryData.value.push({ id: Date.now(), day: currentDay.value, ...newSchedule.value }); newSchedule.value.title = ''; newSchedule.value.location = ''; showAddSchedule.value = false; saveToLocal(); }};
                const deleteSchedule = (id) => { if(confirm('Âà™Èô§Ôºü')) { itineraryData.value = itineraryData.value.filter(i => i.id !== id); saveToLocal(); }};
                const addExpense = () => { if(newExpense.value.name && newExpense.value.amount) { expenses.value.unshift({ ...newExpense.value }); newExpense.value.name = ''; newExpense.value.amount = ''; saveToLocal(); }};
                const deleteExpense = (idx) => { expenses.value.splice(idx, 1); saveToLocal(); };
                const addShopItem = () => { if(newShopItem.value) { shopList.value.unshift({ name: newShopItem.value, done: false }); newShopItem.value = ''; saveToLocal(); }};
                const toggleShopItem = (idx) => { shopList.value[idx].done = !shopList.value[idx].done; saveToLocal(); };
                const deleteShopItem = (idx) => { shopList.value.splice(idx, 1); saveToLocal(); };
                
                // Êñ∞Â¢ûÊ©üÁ•®ÂäüËÉΩ
                const addFlight = () => {
                    if(newFlight.value.flightNo) {
                        flightList.value.push({ ...newFlight.value });
                        // ÈáçÁΩÆ
                        newFlight.value = { airline: '', flightNo: '', from: '', to: '', date: '', time: '', gate: '' };
                        saveToLocal();
                    }
                };
                const deleteFlight = (idx) => {
                     if(confirm('Âà™Èô§ÈÄôÂºµÊ©üÁ•®Ôºü')) { flightList.value.splice(idx, 1); saveToLocal(); }
                };

                const resetAllData = () => { if(confirm('Ê∏ÖÈô§ÊâÄÊúâË≥áÊñôÔºü')) { itineraryData.value = []; expenses.value = []; shopList.value = []; flightList.value = []; userName.value = ''; saveToLocal(); alert('Â∑≤ÈáçÁΩÆ'); }};

                return { currentTab, currentDay, maxDays, showAddSchedule, itineraryData, itineraryDisplay, expenses, shopList, flightList, userName, userAvatar, newSchedule, newExpense, newShopItem, newFlight, pageTitle, totalExpense, getWeatherIcon, addNewDay, addScheduleItem, deleteSchedule, addExpense, deleteExpense, addShopItem, toggleShopItem, deleteShopItem, addFlight, deleteFlight, resetAllData, saveToLocal };
            }
        }).mount('#app');
    </script>
</body>
</html>